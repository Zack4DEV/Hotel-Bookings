<?php namespace App\Http\Controllers; use App\Models\User; use Illuminate\Http\Request; use Illuminate\Support\Facades\Auth; use Illuminate\Support\Facades\Hash; class Users extends Controller { public function _users(Request $request) { $credentials = $request->validate([ 'email' => 'required|email', 'password' => 'required' ]); if (Auth::attempt($credentials)) { $user = Auth::user(); $token = $user->createToken('auth-token')->plainTextToken; return response()->json([ 'user' => $user, 'token' => $token ]); } return response()->json(['message' => 'Invalid credentials'], 401); } public function _store(Request $request) { $validated = $request->validate([ 'room_id' => 'required|exists:rooms,id', 'check_in' => 'required|date', 'check_out' => 'required|date|after:check_in' ]); $booking = Auth::user()->bookings()->create($validated); return response()->json($booking, 201); } public function _logout(Request $request) { Auth::user()->tokens()->delete(); return response()->json(['message' => 'Logged out successfully']); } } 